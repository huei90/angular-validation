(function(){angular.module("validation",["validation.provider","validation.directive"])}).call(this),function(){angular.module("validation.provider",[]).provider("$validation",function(){var a,b,c,d,e,f=this,g=function(f){a=f,b=a.get("$rootScope"),c=a.get("$http"),d=a.get("$q"),e=a.get("$timeout")},h={},i={};this.setExpression=function(a){return angular.extend(h,a),f},this.getExpression=function(a){return h[a]},this.setDefaultMsg=function(a){return angular.extend(i,a),f},this.getDefaultMsg=function(a){return i[a]},this.setErrorHTML=function(a){return a.constructor===Function?(f.getErrorHTML=a,f):void 0},this.getErrorHTML=function(a){return'<p class="validation-invalid">'+a+"</p>"},this.setSuccessHTML=function(a){return a.constructor===Function?(f.getSuccessHTML=a,f):void 0},this.getSuccessHTML=function(a){return'<p class="validation-valid">'+a+"</p>"},this.showSuccessMessage=!0,this.showErrorMessage=!0,this.checkValid=function(a){return void 0===a.$valid?!1:a&&a.$valid===!0},this.validate=function(a){var c=d.defer(),g=0;if(void 0===a)return console.error("This is not a regular Form name scope"),c.reject("This is not a regular Form name scope"),c.promise;if(a.validationId)b.$broadcast(a.$name+"submit-"+a.validationId,g++);else if(a.constructor===Array)for(var h in a)b.$broadcast(a[h].$name+"submit-"+a[h].validationId,g++);else for(var i in a)"$"!==i[0]&&a[i].hasOwnProperty("$dirty")&&b.$broadcast(i+"submit-"+a[i].validationId,g++);return c.promise.success=function(a){return c.promise.then(function(b){a(b)}),c.promise},c.promise.error=function(a){return c.promise.then(null,function(b){a(b)}),c.promise},e(function(){f.checkValid(a)?c.resolve("success"):c.reject("error")}),c.promise},this.validCallback=null,this.invalidCallback=null,this.reset=function(a){if(void 0===a)return void console.error("This is not a regular Form name scope");if(a.validationId)b.$broadcast(a.$name+"reset-"+a.validationId);else if(a.constructor===Array)for(var c in a)b.$broadcast(a[c].$name+"reset-"+a[c].validationId);else for(var d in a)"$"!==d[0]&&a[d].hasOwnProperty("$dirty")&&b.$broadcast(d+"reset-"+a[d].validationId)},this.$get=["$injector",function(a){return g(a),{setErrorHTML:this.setErrorHTML,getErrorHTML:this.getErrorHTML,setSuccessHTML:this.setSuccessHTML,getSuccessHTML:this.getSuccessHTML,setExpression:this.setExpression,getExpression:this.getExpression,setDefaultMsg:this.setDefaultMsg,getDefaultMsg:this.getDefaultMsg,showSuccessMessage:this.showSuccessMessage,showErrorMessage:this.showErrorMessage,checkValid:this.checkValid,validate:this.validate,validCallback:this.validCallback,invalidCallback:this.invalidCallback,reset:this.reset}}]})}.call(this),function(){angular.module("validation.directive",["validation.provider"]).directive("validator",["$injector",function(a){var b=a.get("$validation"),c=a.get("$q"),d=(a.get("$timeout"),function(a,c,d,e,f,g){var h,i=c||b.getDefaultMsg(d).success;return h=e.messageId?angular.element(document.querySelector("#"+e.messageId)):a.next(),b.showSuccessMessage&&i&&!g?(h.html(b.getSuccessHTML(i)),h.css("display","")):h.css("display","none"),f.$setValidity(f.$name,!0),e.validCallback&&e.validCallback(),b.validCallback&&b.validCallback(a),!0}),e=function(a,c,d,e,f,g){var h,i=c||b.getDefaultMsg(d).error;return h=e.messageId?angular.element(document.querySelector("#"+e.messageId)):a.next(),b.showErrorMessage&&i&&!g?(h.html(b.getErrorHTML(i)),h.css("display","")):h.css("display","none"),f.$setValidity(f.$name,!1),e.invalidCallback&&e.invalidCallback(),b.invalidCallback&&b.invalidCallback(a),!1},f=!1,g=function(a,f,h,i,j,k){var l=j.slice(0),m=l[0].trim(),n=l.slice(1),o=m+"SuccessMessage",p=m+"ErrorMessage",q=void 0!==h.noValidationMessage&&"true"===h.noValidationMessage,r=b.getExpression(m),s={success:function(){return d(f,h[o],m,a,i,q),n.length?void g(a,f,h,i,n,k):!0},error:function(){return e(f,h[p],m,a,i,q)}};if(void 0===r){if(console.error('You are using undefined validator "%s"',m),!n.length)return;g(a,f,h,i,n,k)}return r.constructor===Function?c.all([b.getExpression(m)(k,a,f,h)]).then(function(a){return a&&a.length>0&&a[0]?s.success():s.error()},function(){return s.error()}):r.constructor===RegExp&&void 0!==k&&null!==k&&b.getExpression(m).test(k)?s.success():s.error()},h=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},i=function(){return h()+h()+h()+h()};return{restrict:"A",require:"ngModel",scope:{model:"=ngModel",initialValidity:"=initialValidity",validCallback:"=",invalidCallback:"=",messageId:"@"},link:function(a,b,c,d){var e,h=function(){},j=c.validator.split(","),k=d.validationId=i();"boolean"==typeof a.initialValidity&&(e=a.initialValidity),a.messageId||b.after("<span></span>"),d.$setValidity(d.$name,e),a.$on(d.$name+"reset-"+k,function(){h(),f=!1,d.$setViewValue(""),d.$setPristine(),d.$setValidity(d.$name,void 0),d.$render(),a.messageId?angular.element(document.querySelector("#"+a.messageId)).html(""):b.next().html("")}),function(){return a.$on(d.$name+"submit-"+k,function(e,i){var k=d.$viewValue,l=!1;0===i&&(f=!1),l=g(a,b,c,d,j,k),"submit"===c.validMethod&&(h(),h=a.$watch("model",function(e,f){e!==f&&((void 0===e||null===e)&&(e=""),l=g(a,b,c,d,j,e))})),f||l||(f=!0,b[0].focus())}),"blur"===c.validMethod?void b.bind("blur",function(){var e=d.$viewValue;a.$apply(function(){g(a,b,c,d,j,e)})}):void("submit"!==c.validMethod&&"submit-only"!==c.validMethod&&a.$watch("model",function(e){if(d.$pristine&&d.$viewValue)d.$setViewValue(d.$viewValue);else if(d.$pristine)return void(a.messageId?angular.element(document.querySelector("#"+a.messageId)).html(""):b.next().html(""));g(a,b,c,d,j,e)}))}()}}}]).directive("validationSubmit",["$injector",function(a){var b=a.get("$validation"),c=a.get("$timeout"),d=a.get("$parse");return{priority:1,require:"?ngClick",link:function(a,e,f){var g=d(f.validationSubmit)(a);c(function(){e.off("click"),e.on("click",function(c){c.preventDefault(),b.validate(g).success(function(){d(f.ngClick)(a)})})})}}}]).directive("validationReset",["$injector",function(a){var b=a.get("$validation"),c=a.get("$timeout"),d=a.get("$parse");return{link:function(a,e,f){var g=d(f.validationReset)(a);c(function(){e.on("click",function(a){a.preventDefault(),b.reset(g)})})}}}])}.call(this);